/*
 * grunt-rename
 * https://github.com/jdavis/grunt-rename
 *
 * Copyright (c) 2013 Josh Davis
 * Licensed under the MIT license.
 */

'use strict';

var fs = require('fs'),
    path = require('path');

module.exports = function(grunt) {
    grunt.registerMultiTask('rename', 'Move and/or rename files.', function() {
        var done = this.async(),
            options = this.options({
                ignore: false,
            });

        //console.log(options);
        if (!this.files.length) {
            grunt.log.writeln('Moved '+'0'.cyan+' files.');
            return done();
        }

        var files  = this.files;
        this.files.forEach(function(f, i){
            var src = path.resolve(f.orig.src[i]);
            var dest = path.resolve(f.dest.toLowerCase());

            fs.rename(src, dest, function(err){
              if (err) throw err;
              return done();

            })
        });
    });
};
